<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Shu Fai Cheung">
<meta name="dcterms.date" content="2024-09-14">

<title>Parallel Mediation in R: A Tutorial – Blogonresearch</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../favicon.ico" rel="icon">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../blongonresearch_logo.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Blogonresearch</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-r-packages-and-other-tools" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">R Packages and Other Tools</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-r-packages-and-other-tools">    
        <li>
    <a class="dropdown-item" href="https://sfcheung.github.io/manymome/">
 <span class="dropdown-text">manymome: Mediation, moderation, and moderated mediation</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://sfcheung.github.io/semhelpinghands/">
 <span class="dropdown-text">semhelpinghands: Some helpers for doing SEM</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://sfcheung.github.io/semptools/">
 <span class="dropdown-text">semptools: Drawing models from lavaan</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://github.com/sfcheung/semfindr">
 <span class="dropdown-text">semfindr: Influential cases in SEM</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://sfcheung.github.io/stdmod/">
 <span class="dropdown-text">stdmod: Standardized moderation</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://sfcheung.github.io/semlbci/">
 <span class="dropdown-text">semlbci: Likelihood-Based Confidence Interval in SEM</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://osf.io/dbm5c/">
 <span class="dropdown-text">FINDOUT: Influential cases in AMOS</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://github.com/sfcheung/diybootstat">
 <span class="dropdown-text">DIY Bootstrapping in SPSS</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/blogonresearch"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/blogonresearch"> <i class="bi bi-twitter" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="../../index.xml"> <i class="bi bi-rss" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Parallel Mediation in R: A Tutorial</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">R</div>
                <div class="quarto-category">mediation</div>
                <div class="quarto-category">manymome</div>
                <div class="quarto-category">bootstrapping</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Shu Fai Cheung </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">September 14, 2024</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#pre-requisite" id="toc-pre-requisite" class="nav-link active" data-scroll-target="#pre-requisite">Pre-Requisite</a></li>
  <li><a href="#data" id="toc-data" class="nav-link" data-scroll-target="#data">Data</a></li>
  <li><a href="#a-parallel-mediation-model" id="toc-a-parallel-mediation-model" class="nav-link" data-scroll-target="#a-parallel-mediation-model">A Parallel Mediation Model</a></li>
  <li><a href="#fit-the-models-by-lm" id="toc-fit-the-models-by-lm" class="nav-link" data-scroll-target="#fit-the-models-by-lm">Fit the Models by <code>lm()</code></a></li>
  <li><a href="#the-indirect-effects" id="toc-the-indirect-effects" class="nav-link" data-scroll-target="#the-indirect-effects">The Indirect Effects</a>
  <ul class="collapse">
  <li><a href="#combine-the-regression-results" id="toc-combine-the-regression-results" class="nav-link" data-scroll-target="#combine-the-regression-results">Combine the Regression Results</a></li>
  <li><a href="#compute-and-test-the-indirect-effect" id="toc-compute-and-test-the-indirect-effect" class="nav-link" data-scroll-target="#compute-and-test-the-indirect-effect">Compute and Test the Indirect Effect</a></li>
  <li><a href="#standardized-indirect-effect" id="toc-standardized-indirect-effect" class="nav-link" data-scroll-target="#standardized-indirect-effect">Standardized Indirect Effect</a></li>
  </ul></li>
  <li><a href="#total-indirect-effect" id="toc-total-indirect-effect" class="nav-link" data-scroll-target="#total-indirect-effect">Total Indirect Effect</a></li>
  <li><a href="#difference-in-indirect-effects" id="toc-difference-in-indirect-effects" class="nav-link" data-scroll-target="#difference-in-indirect-effects">Difference in Indirect Effects</a></li>
  <li><a href="#a-parallel-mediation-model-with-some-control-variables" id="toc-a-parallel-mediation-model-with-some-control-variables" class="nav-link" data-scroll-target="#a-parallel-mediation-model-with-some-control-variables">A Parallel Mediation Model With Some Control Variables</a></li>
  <li><a href="#no-limit-on-the-number-of-mediators" id="toc-no-limit-on-the-number-of-mediators" class="nav-link" data-scroll-target="#no-limit-on-the-number-of-mediators">No Limit On The Number of Mediators</a></li>
  <li><a href="#easy-to-fit-models-with-only-some-paths-included" id="toc-easy-to-fit-models-with-only-some-paths-included" class="nav-link" data-scroll-target="#easy-to-fit-models-with-only-some-paths-included">Easy To Fit Models With Only Some Paths Included</a></li>
  <li><a href="#advanced-topics" id="toc-advanced-topics" class="nav-link" data-scroll-target="#advanced-topics">Advanced Topics</a>
  <ul class="collapse">
  <li><a href="#customize-the-printout" id="toc-customize-the-printout" class="nav-link" data-scroll-target="#customize-the-printout">Customize the Printout</a></li>
  <li><a href="#missing-data" id="toc-missing-data" class="nav-link" data-scroll-target="#missing-data">Missing Data</a></li>
  </ul></li>
  <li><a href="#functions-used-in-this-example" id="toc-functions-used-in-this-example" class="nav-link" data-scroll-target="#functions-used-in-this-example">Functions Used In This Example</a></li>
  <li><a href="#further-information" id="toc-further-information" class="nav-link" data-scroll-target="#further-information">Further Information</a></li>
  <li><a href="#disclaimer-similarity-across-tutorials" id="toc-disclaimer-similarity-across-tutorials" class="nav-link" data-scroll-target="#disclaimer-similarity-across-tutorials">Disclaimer: Similarity Across Tutorials</a></li>
  <li><a href="#revision-history-and-issues" id="toc-revision-history-and-issues" class="nav-link" data-scroll-target="#revision-history-and-issues">Revision History and Issues</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<p>This tutorial shows how to use the R package <a href="https://sfcheung.github.io/manymome"><code>manymome</code></a> <span class="citation" data-cites="cheung_manymome_2023">(<a href="#ref-cheung_manymome_2023" role="doc-biblioref">S. F. Cheung &amp; Cheung, 2023</a>)</span>, a flexible package for mediation analysis, to test indirect effects in a parallel mediation model fitted by multiple regression.</p>
<section id="pre-requisite" class="level1">
<h1>Pre-Requisite</h1>
<p>Readers are expected to have basic R skills and know how to fit a linear regression model using <code>lm()</code>.</p>
<p>The package <code>manymome</code> can be installed from CRAN:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"manymome"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="data" class="level1">
<h1>Data</h1>
<p>This is the data file for illustration, from <code>manymome</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(manymome)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data_parallel, <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         x       m1       m2        y       c1       c2
1 9.652688 20.77622 8.977183 16.85574 2.385207 4.009182
2 9.011756 18.28393 6.518089 15.99256 2.585124 5.980229
3 9.343317 18.00133 6.271594 20.12393 2.667239 4.170771</code></pre>
</div>
</div>
</section>
<section id="a-parallel-mediation-model" class="level1">
<h1>A Parallel Mediation Model</h1>
<p>First we fit a parallel mediation model using only <code>x</code>, <code>m1</code>, <code>m2</code>, and <code>y</code>.</p>
<div class="cell" data-layout-align="center" data-fig-heigh="3">
<div class="cell-output-display">
<div id="fig-full-model" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-full-model-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="index_files/figure-html/fig-full-model-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-full-model-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: A Parallel Mediation Model
</figcaption>
</figure>
</div>
</div>
</div>
<p>In this model:</p>
<ul>
<li><p><code>x</code> is the predictor (independent variable).</p></li>
<li><p><code>y</code> is the outcome variable (dependent variable).</p></li>
<li><p><code>m1</code> and <code>m2</code> are the mediators.</p></li>
</ul>
<p>The goal is to compute and test the two indirect effects:</p>
<ul>
<li><p>From <code>x</code> to <code>y</code> through <code>m1</code>.</p></li>
<li><p>From <code>x</code> to <code>y</code> through <code>m2</code>.</p></li>
</ul>
</section>
<section id="fit-the-models-by-lm" class="level1">
<h1>Fit the Models by <code>lm()</code></h1>
<p>To estimate all the regression coefficients, just fit three regression models:</p>
<ul>
<li><p>Predict <code>m1</code> by <code>x</code> (<a href="#fig-m1-model" class="quarto-xref">Figure&nbsp;2</a>).</p></li>
<li><p>Predict <code>m2</code> by <code>x</code> (<a href="#fig-m2-model" class="quarto-xref">Figure&nbsp;3</a>).</p></li>
<li><p>Predict <code>y</code> by <code>m1</code>, <code>m2</code>, and <code>x</code> (<a href="#fig-y-model" class="quarto-xref">Figure&nbsp;4</a>).</p></li>
</ul>
<div class="cell" data-layout-align="center" data-fig-heigh="3">
<div class="cell-output-display">
<div id="fig-m1-model" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-m1-model-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="index_files/figure-html/fig-m1-model-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-m1-model-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: The Model Predicting <code>m1</code>
</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center" data-fig-heigh="3">
<div class="cell-output-display">
<div id="fig-m2-model" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-m2-model-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="index_files/figure-html/fig-m2-model-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-m2-model-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: The Model Predicting <code>m2</code>
</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center" data-fig-heigh="3">
<div class="cell-output-display">
<div id="fig-y-model" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-y-model-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="index_files/figure-html/fig-y-model-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-y-model-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: The Model Predicting <code>y</code>
</figcaption>
</figure>
</div>
</div>
</div>
<p>This can be easily done by <code>lm()</code> in R:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict m1</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>model_m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(m1 <span class="sc">~</span> x,</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> data_parallel)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict m2</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>model_m2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(m2 <span class="sc">~</span> x,</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> data_parallel)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict y</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>model_y <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> m1 <span class="sc">+</span> m2 <span class="sc">+</span> x,</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> data_parallel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>These are the regression results:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Call:
lm(formula = m1 ~ x, data = data_parallel)

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   9.0203     1.1288   7.991 2.65e-12 ***
x             0.9247     0.1128   8.200 9.49e-13 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.125 on 98 degrees of freedom
Multiple R-squared:  0.4069,    Adjusted R-squared:  0.4009 
F-statistic: 67.24 on 1 and 98 DF,  p-value: 9.488e-13</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_m2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Call:
lm(formula = m2 ~ x, data = data_parallel)

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   2.5066     1.1248   2.229 0.028128 *  
x             0.3921     0.1124   3.490 0.000726 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.121 on 98 degrees of freedom
Multiple R-squared:  0.1105,    Adjusted R-squared:  0.1015 
F-statistic: 12.18 on 1 and 98 DF,  p-value: 0.000726</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Call:
lm(formula = y ~ m1 + m2 + x, data = data_parallel)

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)  
(Intercept)   2.4554     2.6015   0.944   0.3476  
m1            0.4784     0.1861   2.571   0.0117 *
m2            0.4684     0.1867   2.508   0.0138 *
x             0.3003     0.2646   1.135   0.2593  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.017 on 96 degrees of freedom
Multiple R-squared:  0.2823,    Adjusted R-squared:  0.2599 
F-statistic: 12.59 on 3 and 96 DF,  p-value: 5.212e-07</code></pre>
</div>
</div>
<p>The direct effect is the coefficient of <code>x</code> in the model predicting <code>y</code>, which is 0.300, and not significant.</p>
</section>
<section id="the-indirect-effects" class="level1">
<h1>The Indirect Effects</h1>
<p>The two indirect effects are the product of the <code>a1</code>-path and <code>b1</code>-path and that of the <code>a2</code>-path and <code>b2</code>-path, respectively:</p>
<ul>
<li><p><code>x</code> -&gt; <code>m1</code> -&gt; <code>y</code></p>
<ul>
<li>Computed by <code>a1</code> × <code>b1</code></li>
</ul></li>
<li><p><code>x</code> -&gt; <code>m2</code> -&gt; <code>y</code></p>
<ul>
<li>Computed by <code>a2</code> × <code>b2</code></li>
</ul></li>
</ul>
<p>To test these indirect effects, one common method is nonparametric bootstrapping <span class="citation" data-cites="cheung_comparison_2009">MacKinnon et al. (<a href="#ref-mackinnon_comparison_2002" role="doc-biblioref">2002</a>)</span>. This can be done easily by <code>indirect_effect()</code> from the package <code>manymome</code>.</p>
<section id="combine-the-regression-results" class="level2">
<h2 class="anchored" data-anchor-id="combine-the-regression-results">Combine the Regression Results</h2>
<p>We first combine the regression models by <a href="https://sfcheung.github.io/manymome/reference/lm2list.html"><code>lm2list()</code></a> into one object to represent the whole model (<a href="#fig-full-model" class="quarto-xref">Figure&nbsp;1</a>):<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>full_model <span class="ot">&lt;-</span> <span class="fu">lm2list</span>(model_m1,</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>                      model_m2,</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>                      model_y)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>full_model</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
The models:
m1 ~ x
m2 ~ x
y ~ m1 + m2 + x</code></pre>
</div>
</div>
</section>
<section id="compute-and-test-the-indirect-effect" class="level2">
<h2 class="anchored" data-anchor-id="compute-and-test-the-indirect-effect">Compute and Test the Indirect Effect</h2>
<p>For this parallel mediation model, we can simply use <a href="https://sfcheung.github.io/manymome/reference/cond_indirect.html"><code>indirect_effect()</code></a></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>ind1 <span class="ot">&lt;-</span> <span class="fu">indirect_effect</span>(<span class="at">x =</span> <span class="st">"x"</span>,</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>                        <span class="at">y =</span> <span class="st">"y"</span>,</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>                        <span class="at">m =</span> <span class="st">"m1"</span>,</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>                        <span class="at">fit =</span> full_model,</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>                        <span class="at">boot_ci =</span> <span class="cn">TRUE</span>,</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>                        <span class="at">R =</span> <span class="dv">5000</span>,</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>                        <span class="at">seed =</span> <span class="dv">3456</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>These are the main arguments:</p>
<ul>
<li><p><code>x</code>: The name of the <code>x</code> variable, the start of the indirect path.</p></li>
<li><p><code>y</code>: The name of the <code>y</code> variable, the end of the indirect path.</p></li>
<li><p><code>m</code>: The name of the mediator, <code>m1</code> in the above example.</p></li>
<li><p><code>fit</code>: The regression models combined by <code>lm2list()</code>.</p></li>
<li><p><code>boot_ci</code>: If <code>TRUE</code>, bootstrap confidence interval will be formed.</p></li>
<li><p><code>R</code>, the number of bootstrap samples. It is fast for regression models and I recommend using at least 5000 bootstrap samples or even 10000, because the results may not be stable enough if indirect effect is close to zero <span class="citation" data-cites="cheung_semlbci_2023">(an example can be found in <a href="#ref-cheung_semlbci_2023" role="doc-biblioref">S. F. Cheung &amp; Pesigan, 2023</a>)</span>.</p></li>
<li><p><code>seed</code>: The seed for the random number generator, to make the resampling reproducible. This argument should always be set when doing bootstrapping.</p></li>
</ul>
<p>By default, parallel processing will be used and a progress bar will be displayed.</p>
<p>The other indirect effect can be computed similarly:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>ind2 <span class="ot">&lt;-</span> <span class="fu">indirect_effect</span>(<span class="at">x =</span> <span class="st">"x"</span>,</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>                        <span class="at">y =</span> <span class="st">"y"</span>,</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>                        <span class="at">m =</span> <span class="st">"m2"</span>,</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>                        <span class="at">fit =</span> full_model,</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>                        <span class="at">boot_ci =</span> <span class="cn">TRUE</span>,</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>                        <span class="at">R =</span> <span class="dv">5000</span>,</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>                        <span class="at">seed =</span> <span class="dv">3456</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Just typing the name of the output can print the major results</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>ind1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
== Indirect Effect  ==
                                     
 Path:               x -&gt; m1 -&gt; y    
 Indirect Effect:    0.442           
 95.0% Bootstrap CI: [0.103 to 0.803]

Computation Formula:
  (b.m1~x)*(b.y~m1)
Computation:
  (0.92471)*(0.47840)

Percentile confidence interval formed by nonparametric bootstrapping
with 5000 bootstrap samples.

Coefficients of Component Paths:
 Path Coefficient
 m1~x       0.925
 y~m1       0.478</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>ind2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
== Indirect Effect  ==
                                     
 Path:               x -&gt; m2 -&gt; y    
 Indirect Effect:    0.184           
 95.0% Bootstrap CI: [0.027 to 0.402]

Computation Formula:
  (b.m2~x)*(b.y~m2)
Computation:
  (0.39215)*(0.46844)

Percentile confidence interval formed by nonparametric bootstrapping
with 5000 bootstrap samples.

Coefficients of Component Paths:
 Path Coefficient
 m2~x       0.392
 y~m2       0.468</code></pre>
</div>
</div>
<p>As shown above, the indirect effect through <code>m1</code> is 0.442. The 95% bootstrap confidence interval is [0.103; 0.803]. The indirect effect is positive and significant.</p>
<p>As shown above, the indirect effect through <code>m2</code> is 0.184. The 95% bootstrap confidence interval is [0.027; 0.402]. The indirect effect is positive and significant.</p>
<p>For transparency, the output also shows how the indirect effect was computed.</p>
</section>
<section id="standardized-indirect-effect" class="level2">
<h2 class="anchored" data-anchor-id="standardized-indirect-effect">Standardized Indirect Effect</h2>
<p>To compute and test the standardized indirect effect, with both the <code>x</code>-variable and <code>y</code>-variable standardized, add <code>standardized_x = TRUE</code> and <code>standardized_y = TRUE</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>ind1_stdxy <span class="ot">&lt;-</span> <span class="fu">indirect_effect</span>(<span class="at">x =</span> <span class="st">"x"</span>,</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>                              <span class="at">y =</span> <span class="st">"y"</span>,</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>                              <span class="at">m =</span> <span class="st">"m1"</span>,</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>                              <span class="at">fit =</span> full_model,</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>                              <span class="at">boot_ci =</span> <span class="cn">TRUE</span>,</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>                              <span class="at">R =</span> <span class="dv">5000</span>,</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>                              <span class="at">seed =</span> <span class="dv">3456</span>,</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>                              <span class="at">standardized_x =</span> <span class="cn">TRUE</span>,</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>                              <span class="at">standardized_y =</span> <span class="cn">TRUE</span>)</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>ind2_stdxy <span class="ot">&lt;-</span> <span class="fu">indirect_effect</span>(<span class="at">x =</span> <span class="st">"x"</span>,</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>                              <span class="at">y =</span> <span class="st">"y"</span>,</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>                              <span class="at">m =</span> <span class="st">"m2"</span>,</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>                              <span class="at">fit =</span> full_model,</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>                              <span class="at">boot_ci =</span> <span class="cn">TRUE</span>,</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>                              <span class="at">R =</span> <span class="dv">5000</span>,</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>                              <span class="at">seed =</span> <span class="dv">3456</span>,</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>                              <span class="at">standardized_x =</span> <span class="cn">TRUE</span>,</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>                              <span class="at">standardized_y =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The results can be printed as usual:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>ind1_stdxy</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
== Indirect Effect (Both 'x' and 'y' Standardized) ==
                                     
 Path:               x -&gt; m1 -&gt; y    
 Indirect Effect:    0.189           
 95.0% Bootstrap CI: [0.045 to 0.340]

Computation Formula:
  (b.m1~x)*(b.y~m1)*sd_x/sd_y
Computation:
  (0.92471)*(0.47840)*(1.00306)/(2.34506)

Percentile confidence interval formed by nonparametric bootstrapping
with 5000 bootstrap samples.

Coefficients of Component Paths:
 Path Coefficient
 m1~x       0.925
 y~m1       0.478

NOTE:
- The effects of the component paths are from the model, not
  standardized.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>ind2_stdxy</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
== Indirect Effect (Both 'x' and 'y' Standardized) ==
                                     
 Path:               x -&gt; m2 -&gt; y    
 Indirect Effect:    0.079           
 95.0% Bootstrap CI: [0.013 to 0.166]

Computation Formula:
  (b.m2~x)*(b.y~m2)*sd_x/sd_y
Computation:
  (0.39215)*(0.46844)*(1.00306)/(2.34506)

Percentile confidence interval formed by nonparametric bootstrapping
with 5000 bootstrap samples.

Coefficients of Component Paths:
 Path Coefficient
 m2~x       0.392
 y~m2       0.468

NOTE:
- The effects of the component paths are from the model, not
  standardized.</code></pre>
</div>
</div>
<p>The standardized indirect effect through <code>m1</code> is 0.189. The 95% bootstrap confidence interval is [0.045; 0.340], significant.</p>
<p>The standardized indirect effect through <code>m2</code> is 0.079. The 95% bootstrap confidence interval is [0.013; 0.166], significant.</p>
</section>
</section>
<section id="total-indirect-effect" class="level1">
<h1>Total Indirect Effect</h1>
<p>Suppose we would like to compute the total indirect effects from <code>x</code> to <code>y</code> through the two parallel paths. This can be done by “adding” the indirect effects computed above, simply by using the <code>+</code> operator:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>ind_total <span class="ot">&lt;-</span> ind1 <span class="sc">+</span> ind2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>ind_total</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
== Indirect Effect  ==
                                      
 Path:                x -&gt; m1 -&gt; y    
 Path:                x -&gt; m2 -&gt; y    
 Function of Effects: 0.626           
 95.0% Bootstrap CI:  [0.276 to 1.065]

Computation of the Function of Effects:
 (x-&gt;m1-&gt;y)
+(x-&gt;m2-&gt;y) 


Percentile confidence interval formed by nonparametric bootstrapping
with 5000 bootstrap samples.</code></pre>
</div>
</div>
<p>The standardized total indirect effect can be computed similarly:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>ind_total_stdxy <span class="ot">&lt;-</span> ind1_stdxy <span class="sc">+</span> ind2_stdxy</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>ind_total_stdxy</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
== Indirect Effect (Both 'x' and 'y' Standardized) ==
                                      
 Path:                x -&gt; m1 -&gt; y    
 Path:                x -&gt; m2 -&gt; y    
 Function of Effects: 0.268           
 95.0% Bootstrap CI:  [0.122 to 0.431]

Computation of the Function of Effects:
 (x-&gt;m1-&gt;y)
+(x-&gt;m2-&gt;y) 


Percentile confidence interval formed by nonparametric bootstrapping
with 5000 bootstrap samples.</code></pre>
</div>
</div>
<p>The total indirect effect through the two paths is 0.626. The 95% bootstrap confidence interval is [0.276; 1.065], significant.</p>
<p>The total standardized indirect effect through the two paths is 0.268. The 95% bootstrap confidence interval is [0.122; 0.431]</p>
</section>
<section id="difference-in-indirect-effects" class="level1">
<h1>Difference in Indirect Effects</h1>
<p>The indirect effects through the two paths are substantially different (0.442 vs.&nbsp;0.184). Suppose we would like to compare the two paths by computing the <em>difference</em> in indirect effect and forming the bootstrap confidence interval of this difference. This can be done by literally computing the difference using the <code>-</code> operator:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>ind_diff <span class="ot">&lt;-</span> ind1 <span class="sc">-</span> ind2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>ind_diff</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
== Indirect Effect  ==
                                       
 Path:                x -&gt; m1 -&gt; y     
 Path:                x -&gt; m2 -&gt; y     
 Function of Effects: 0.259            
 95.0% Bootstrap CI:  [-0.165 to 0.659]

Computation of the Function of Effects:
 (x-&gt;m1-&gt;y)
-(x-&gt;m2-&gt;y) 


Percentile confidence interval formed by nonparametric bootstrapping
with 5000 bootstrap samples.</code></pre>
</div>
</div>
<p>Interestingly, despite the apparent magnitude of the difference, the two indirect effects are not significantly different, probably due to the small sample size (100).</p>
<p>The difference in standardized indirect effects (0.189 vs.&nbsp;0.079) can be computed similarly:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>ind_stdxy_diff <span class="ot">&lt;-</span> ind1_stdxy <span class="sc">-</span> ind2_stdxy</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>ind_stdxy_diff</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
== Indirect Effect (Both 'x' and 'y' Standardized) ==
                                       
 Path:                x -&gt; m1 -&gt; y     
 Path:                x -&gt; m2 -&gt; y     
 Function of Effects: 0.111            
 95.0% Bootstrap CI:  [-0.072 to 0.281]

Computation of the Function of Effects:
 (x-&gt;m1-&gt;y)
-(x-&gt;m2-&gt;y) 


Percentile confidence interval formed by nonparametric bootstrapping
with 5000 bootstrap samples.</code></pre>
</div>
</div>
</section>
<section id="a-parallel-mediation-model-with-some-control-variables" class="level1">
<h1>A Parallel Mediation Model With Some Control Variables</h1>
<p>Suppose we want to fit a more complicated model, with some other variables included, such as control variables <code>c1</code> and <code>c2</code> in the dataset (<a href="#fig-full-model2" class="quarto-xref">Figure&nbsp;5</a>).</p>
<div class="cell" data-layout-align="center" data-fig-caption="A Parallel Mediation Model With Control Variables" data-fig-heigh="5">
<div class="cell-output-display">
<div id="fig-full-model2" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" width="576">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-full-model2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="index_files/figure-html/fig-full-model2-1.png" id="fig-full-model2" class="img-fluid quarto-figure quarto-figure-center anchored figure-img" width="576">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-full-model2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5
</figcaption>
</figure>
</div>
</div>
</div>
<p>Although there are more predictors (<code>c1</code> and <code>c2</code>) and more direct and indirect paths (e.g., <code>c1</code> to <code>y</code> through <code>m1</code>), there are still only just three regression models. We can fit them as usual by <code>lm()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>model2_m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(m1 <span class="sc">~</span> x <span class="sc">+</span> c1 <span class="sc">+</span> c2,</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> data_parallel)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>model2_m2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(m2 <span class="sc">~</span> x <span class="sc">+</span> c1 <span class="sc">+</span> c2,</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> data_parallel)</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>model2_y <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> m1 <span class="sc">+</span> m2 <span class="sc">+</span> x <span class="sc">+</span> c1 <span class="sc">+</span> c2,</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> data_parallel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>These are the regression results:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model2_m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Call:
lm(formula = m1 ~ x + c1 + c2, data = data_parallel)

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  9.39260    1.40019   6.708 1.37e-09 ***
x            0.87694    0.11441   7.665 1.45e-11 ***
c1           0.25189    0.11131   2.263   0.0259 *  
c2          -0.09293    0.12255  -0.758   0.4501    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.106 on 96 degrees of freedom
Multiple R-squared:  0.4394,    Adjusted R-squared:  0.4219 
F-statistic: 25.08 on 3 and 96 DF,  p-value: 4.558e-12</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model2_m2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Call:
lm(formula = m2 ~ x + c1 + c2, data = data_parallel)

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)   
(Intercept)   4.3796     1.3463   3.253  0.00158 **
x             0.2968     0.1100   2.698  0.00825 **
c1            0.2746     0.1070   2.566  0.01185 * 
c2           -0.3125     0.1178  -2.652  0.00937 **
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.063 on 96 degrees of freedom
Multiple R-squared:  0.2171,    Adjusted R-squared:  0.1927 
F-statistic: 8.875 on 3 and 96 DF,  p-value: 3e-05</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model2_y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Call:
lm(formula = y ~ m1 + m2 + x + c1 + c2, data = data_parallel)

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)  
(Intercept)  2.65618    3.17697   0.836   0.4052  
m1           0.48642    0.19106   2.546   0.0125 *
m2           0.47128    0.19871   2.372   0.0197 *
x            0.29112    0.26939   1.081   0.2826  
c1          -0.05256    0.21557  -0.244   0.8079  
c2          -0.03212    0.23411  -0.137   0.8912  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.038 on 94 degrees of freedom
F-statistic:  7.42 on 5 and 94 DF,  p-value: 6.649e-06</code></pre>
</div>
</div>
<p>We then just combine them by <code>lm2list()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>full_model2 <span class="ot">&lt;-</span> <span class="fu">lm2list</span>(model2_m1,</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>                       model2_m2,</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>                       model2_y)</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>full_model2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
The models:
m1 ~ x + c1 + c2
m2 ~ x + c1 + c2
y ~ m1 + m2 + x + c1 + c2</code></pre>
</div>
</div>
<p>The indirect effects can be computed and tested in exactly the same way:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>ind2_1 <span class="ot">&lt;-</span> <span class="fu">indirect_effect</span>(<span class="at">x =</span> <span class="st">"x"</span>,</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>                          <span class="at">y =</span> <span class="st">"y"</span>,</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">m =</span> <span class="st">"m1"</span>,</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fit =</span> full_model2,</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>                          <span class="at">boot_ci =</span> <span class="cn">TRUE</span>,</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>                          <span class="at">R =</span> <span class="dv">5000</span>,</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>                          <span class="at">seed =</span> <span class="dv">3456</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>ind2_2 <span class="ot">&lt;-</span> <span class="fu">indirect_effect</span>(<span class="at">x =</span> <span class="st">"x"</span>,</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>                          <span class="at">y =</span> <span class="st">"y"</span>,</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">m =</span> <span class="st">"m2"</span>,</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fit =</span> full_model2,</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>                          <span class="at">boot_ci =</span> <span class="cn">TRUE</span>,</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>                          <span class="at">R =</span> <span class="dv">5000</span>,</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>                          <span class="at">seed =</span> <span class="dv">3456</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This is the result:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>ind2_1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
== Indirect Effect  ==
                                     
 Path:               x -&gt; m1 -&gt; y    
 Indirect Effect:    0.427           
 95.0% Bootstrap CI: [0.095 to 0.804]

Computation Formula:
  (b.m1~x)*(b.y~m1)
Computation:
  (0.87694)*(0.48642)

Percentile confidence interval formed by nonparametric bootstrapping
with 5000 bootstrap samples.

Coefficients of Component Paths:
 Path Coefficient
 m1~x       0.877
 y~m1       0.486</code></pre>
</div>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>ind2_2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
== Indirect Effect  ==
                                     
 Path:               x -&gt; m2 -&gt; y    
 Indirect Effect:    0.140           
 95.0% Bootstrap CI: [0.006 to 0.359]

Computation Formula:
  (b.m2~x)*(b.y~m2)
Computation:
  (0.29677)*(0.47128)

Percentile confidence interval formed by nonparametric bootstrapping
with 5000 bootstrap samples.

Coefficients of Component Paths:
 Path Coefficient
 m2~x       0.297
 y~m2       0.471</code></pre>
</div>
</div>
<p>The indirect effect through <code>m1</code> is 0.427. The 95% bootstrap confidence interval is [0.095; 0.804], slightly decreased after the control variables are included, but still significant.</p>
<p>The indirect effect through <code>m2</code> is 0.140. The 95% bootstrap confidence interval is [0.006; 0.359], decreased after the control variables are included, but still significant.</p>
<p>Standardized indirect effects can also be computed and tested just by adding <code>standardized_x = TRUE</code> and <code>standardized_y = TRUE</code>.</p>
<p>The total indirect effect can also be computed using <code>+</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>ind2_total <span class="ot">&lt;-</span> ind2_1 <span class="sc">+</span> ind2_2</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>ind2_total</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
== Indirect Effect  ==
                                      
 Path:                x -&gt; m1 -&gt; y    
 Path:                x -&gt; m2 -&gt; y    
 Function of Effects: 0.566           
 95.0% Bootstrap CI:  [0.227 to 1.020]

Computation of the Function of Effects:
 (x-&gt;m1-&gt;y)
+(x-&gt;m2-&gt;y) 


Percentile confidence interval formed by nonparametric bootstrapping
with 5000 bootstrap samples.</code></pre>
</div>
</div>
</section>
<section id="no-limit-on-the-number-of-mediators" class="level1">
<h1>No Limit On The Number of Mediators</h1>
<p>Although the example above only has two mediators, there is no limit on the number of mediators in the parallel mediation model. Just fit all the regression models predicting the mediators, combine them by <code>lm2list()</code>, and compute the indirect effect as illustrated above for each path.</p>
</section>
<section id="easy-to-fit-models-with-only-some-paths-included" class="level1">
<h1>Easy To Fit Models With Only Some Paths Included</h1>
<p>Although control variables predict all variables other than <code>x</code>, it is easy to fit a model with only paths theoretically meaningful:</p>
<ul>
<li>Just fit the desired models by <code>lm()</code> and use <code>indirect_effect()</code> as usual.</li>
</ul>
<p>For example, suppose this is the desired model (<a href="#fig-full-model3" class="quarto-xref">Figure&nbsp;6</a>):</p>
<div class="cell" data-layout-align="center" data-fig-caption="A Parallel Mediation Model With Some Paths Omitted" data-fig-heigh="5">
<div class="cell-output-display">
<div id="fig-full-model3" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" width="576">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-full-model3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="index_files/figure-html/fig-full-model3-1.png" id="fig-full-model3" class="img-fluid quarto-figure quarto-figure-center anchored figure-img" width="576">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-full-model3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6
</figcaption>
</figure>
</div>
</div>
</div>
<p>The control variable <code>c1</code> only predicts <code>m1</code> and <code>m2</code>, and the control variable <code>c2</code> only predicts <code>y</code>.</p>
<p>We just fit the three models using <code>lm()</code> based on the hypothesized model:</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict m1</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>model_m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(m1 <span class="sc">~</span> x <span class="sc">+</span> c1,</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> data_parallel)</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict m2</span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>model_m2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(m2 <span class="sc">~</span> x <span class="sc">+</span> c1,</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> data_parallel)</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict y</span></span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>model_y <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> m1 <span class="sc">+</span> m2 <span class="sc">+</span> x <span class="sc">+</span> c2,</span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> data_parallel)</span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine the models</span></span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>full_model <span class="ot">&lt;-</span> <span class="fu">lm2list</span>(model_m1,</span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a>                      model_m2,</span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a>                      model_y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Then the indirect effects can be computed as before.</p>
</section>
<section id="advanced-topics" class="level1">
<h1>Advanced Topics</h1>
<section id="customize-the-printout" class="level2">
<h2 class="anchored" data-anchor-id="customize-the-printout">Customize the Printout</h2>
<p>The printout can be customized in several ways. For example:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(ind1,</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">digits =</span> <span class="dv">2</span>,</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">pvalue =</span> <span class="cn">TRUE</span>,</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">pvalue_digits =</span> <span class="dv">3</span>,</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">se =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
== Indirect Effect  ==
                                   
 Path:               x -&gt; m1 -&gt; y  
 Indirect Effect:    0.44          
 95.0% Bootstrap CI: [0.10 to 0.80]
 Bootstrap p-value:  0.006         
 Bootstrap SE:       0.18          

Computation Formula:
  (b.m1~x)*(b.y~m1)
Computation:
  (0.92471)*(0.47840)

Percentile confidence interval formed by nonparametric bootstrapping
with 5000 bootstrap samples.
Standard error (SE) based on nonparametric bootstrapping with 5000
bootstrap samples.

Coefficients of Component Paths:
 Path Coefficient
 m1~x        0.92
 y~m1        0.48</code></pre>
</div>
</div>
<ul>
<li><p><code>digits</code>: The number of digits after the decimal point for major output. Default is 3.</p></li>
<li><p><code>pvalue</code>: Whether bootstrapping <em>p</em>-value is printed. The method by <span class="citation" data-cites="asparouhov_bootstrap_2021">Asparouhov &amp; Muthén (<a href="#ref-asparouhov_bootstrap_2021" role="doc-biblioref">2021</a>)</span> is used.</p></li>
<li><p><code>pvalue_digits</code>: The number of digits after the decimal point for the <em>p</em>-value. Default is 3.</p></li>
<li><p><code>se</code>: The standard error based on bootstrapping (i.e., the standard deviation of the bootstrap estimates).</p></li>
</ul>
</section>
<section id="missing-data" class="level2">
<h2 class="anchored" data-anchor-id="missing-data">Missing Data</h2>
<p>Care needs to be taken if missing data is present. Let’s remove some data points from the data file:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>data_parallel_missing <span class="ot">&lt;-</span> data_parallel</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>data_parallel_missing[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="st">"x"</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>data_parallel_missing[<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>, <span class="st">"m1"</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>data_parallel_missing[<span class="dv">3</span><span class="sc">:</span><span class="dv">5</span>, <span class="st">"m2"</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>data_parallel_missing[<span class="dv">3</span><span class="sc">:</span><span class="dv">6</span>, <span class="st">"y"</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data_parallel_missing)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         x       m1       m2        y       c1       c2
1       NA 20.77622 8.977183 16.85574 2.385207 4.009182
2       NA       NA 6.518089 15.99256 2.585124 5.980229
3       NA       NA       NA       NA 2.667239 4.170771
4 9.272600       NA       NA       NA 2.021972 3.819458
5 9.845673 18.29027       NA       NA 3.796376 4.375370
6 9.147475 18.21173 7.167020       NA 3.686640 5.283557</code></pre>
</div>
</div>
<p>If we do the regression separately, the cases used in the two models will be different:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict m1</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>model_m1_missing <span class="ot">&lt;-</span> <span class="fu">lm</span>(m1 <span class="sc">~</span> x,</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">data =</span> data_parallel_missing)</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>model_m2_missing <span class="ot">&lt;-</span> <span class="fu">lm</span>(m2 <span class="sc">~</span> x,</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>                      <span class="at">data =</span> data_parallel_missing)</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict y</span></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>model_y_missing <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> m1 <span class="sc">+</span> m2 <span class="sc">+</span> x,</span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>                      <span class="at">data =</span> data_parallel_missing)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The sample sizes are not the same:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nobs</span>(model_m1_missing)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 96</code></pre>
</div>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nobs</span>(model_m2_missing)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 95</code></pre>
</div>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nobs</span>(model_y_missing)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 94</code></pre>
</div>
</div>
<p>If they are combined by <code>lm2list()</code>, an error will occur. The function <code>lm2list()</code> will compare the data to see if the cases used are likely to be different.<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm2list</span>(model_m1_missing,</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>        model_m2_missing,</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>        model_y_missing)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in check_lm_consistency(...): The data sets used in the lm models do not have identical sample size. All lm models must be fitted to the same sample.</code></pre>
</div>
</div>
<p>A simple (though not ideal) solution is to use listwise deletion, keeping only cases with complete data. This can be done by <code>na.omit()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>data_parallel_listwise <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(data_parallel_missing)</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data_parallel_listwise)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           x       m1       m2        y        c1       c2
7  10.602289 17.75832 5.944234 18.76106  1.570251 5.629544
8  10.244337 19.31993 6.367723 21.26092  2.140513 5.243080
9   8.877403 16.03285 4.035743 15.64276  2.697043 6.316437
10  9.995130 17.84715 6.219250 12.16667  1.557163 5.536002
11  9.214953 17.30516 6.416709 15.66863  3.157459 6.613625
12 10.178196 17.76963 4.411447 18.68844 -0.127799 5.796077</code></pre>
</div>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(data_parallel_listwise)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 94</code></pre>
</div>
</div>
<p>The number of cases using listwise deletion is 94, less than the full sample with missing data (94).</p>
<p>The steps above can then be proceed as usual.</p>
</section>
</section>
<section id="functions-used-in-this-example" class="level1">
<h1>Functions Used In This Example</h1>
<p>These are the main functions used:</p>
<ul>
<li><p><a href="https://sfcheung.github.io/manymome/reference/lm2list.html"><code>lm2list()</code></a>: Combining the results of several one-outcome regression models.</p></li>
<li><p><a href="https://sfcheung.github.io/manymome/reference/cond_indirect.html"><code>indirect_effect()</code></a>: Compute and test an indirect effect.</p></li>
</ul>
</section>
<section id="further-information" class="level1">
<h1>Further Information</h1>
<p>The package <code>manymome</code> has no inherent limitations on the number of variables and the form of the mediation models. An illustration using a more complicated models with both parallel and serial mediation paths can be found in <a href="https://sfcheung.github.io/manymome/articles/med_lm.html">this online article</a>.</p>
<p>Other features of <code>manymome</code> can be found in <a href="https://sfcheung.github.io/manymome/">the website</a> for it.</p>
</section>
<section id="disclaimer-similarity-across-tutorials" class="level1">
<h1>Disclaimer: Similarity Across Tutorials</h1>
<p>To keep each tutorial self-contained, some sections are intentionally repeated nearly verbatim (“recycled”) to reduce the hassle to read several articles to learn how to do one task.</p>
</section>
<section id="revision-history-and-issues" class="level1">
<h1>Revision History and Issues</h1>
<p>The revision history of this post can be find in the <a href="https://github.com/blogonresearch/blogonresearch.github.io/commits/main/posts/manymome_parallel_mediation/index.qmd">GitHub history of the source file</a>.</p>
<p>For issues on this post, such as corrections and mistakes, please <a href="https://github.com/blogonresearch/blogonresearch.github.io/issues">open an issue</a> for the GitHub repository for this blog. Thanks.</p>

<p>:::</p>


</section>


<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list">
<div id="ref-asparouhov_bootstrap_2021" class="csl-entry" role="listitem">
Asparouhov, T., &amp; Muthén, B. O. (2021). <em>Bootstrap <em>p</em>-value computation</em>. <a href="https://www.statmodel.com/download/FAQ-Bootstrap%20-%20Pvalue.pdf">https://www.statmodel.com/download/FAQ-Bootstrap%20-%20Pvalue.pdf</a>
</div>
<div id="ref-cheung_comparison_2009" class="csl-entry" role="listitem">
Cheung, M. W.-L. (2009). Comparison of methods for constructing confidence intervals of standardized indirect effects. <em>Behavior Research Methods</em>, <em>41</em>(2), 425–438. <a href="https://doi.org/10.3758/BRM.41.2.425">https://doi.org/10.3758/BRM.41.2.425</a>
</div>
<div id="ref-cheung_manymome_2023" class="csl-entry" role="listitem">
Cheung, S. F., &amp; Cheung, S.-H. (2023). <em>Manymome</em>: <span>An</span> <span>R</span> package for computing the indirect effects, conditional effects, and conditional indirect effects, standardized or unstandardized, and their bootstrap confidence intervals, in many (though not all) models. <em>Behavior Research Methods</em>. <a href="https://doi.org/10.3758/s13428-023-02224-z">https://doi.org/10.3758/s13428-023-02224-z</a>
</div>
<div id="ref-cheung_semlbci_2023" class="csl-entry" role="listitem">
Cheung, S. F., &amp; Pesigan, I. J. A. (2023). <em>Semlbci</em>: <span>An</span> <span>R</span> package for forming likelihood-based confidence intervals for parameter estimates, correlations, indirect effects, and other derived parameters. <em>Structural Equation Modeling: A Multidisciplinary Journal</em>, <em>30</em>(6), 985–999. <a href="https://doi.org/10.1080/10705511.2023.2183860">https://doi.org/10.1080/10705511.2023.2183860</a>
</div>
<div id="ref-mackinnon_comparison_2002" class="csl-entry" role="listitem">
MacKinnon, D. P., Lockwood, C. M., Hoffman, J. M., West, S. G., &amp; Sheets, V. (2002). A comparison of methods to test mediation and other intervening variable effects. <em>Psychological Methods</em>, <em>7</em>(1), 83–104. <a href="http://www.ncbi.nlm.nih.gov/pmc/articles/PMC2819363/">http://www.ncbi.nlm.nih.gov/pmc/articles/PMC2819363/</a>
</div>
</div></section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>The order does not matter when using <code>lm2list</code>.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>The function <code>lm2list()</code> checks not only sample sizes. Even if the sample sizes are the same, an error will still be raised if there is evidence suggesting that the samples are not the same, such as different values of <code>x</code> in the two models.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/blogonresearch\.github\.io\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
 <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/4.0/88x31.png"></a><br>This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
  </li>  
</ul>
    </div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>